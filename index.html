<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title></title>
    <link href="bootstrap.min.css" type="text/css" rel="stylesheet"/>
    <link href="font-awesome-4.7.0/css/font-awesome.css" type="text/css" rel="stylesheet"/>
    <link href="diy.css" type="text/css" rel="stylesheet"/>
    <link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<form id="forminfo">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-6 col-md-4 col-lg-2dot4">
                <div class="thumbnail thum" style="border:1px solid #F9D8A2;">
                    <div class="bg-info key-info" style="background-color:#F2E6D2;color:#B08133">
                        <span class="pull-left">
                          <div class="checkbox titleWord1">
                              <label>
                                  <input type="checkbox"/>
                                  <strong>地区</strong>
                              </label>
                          </div>
                        </span>
                        <span class="pull-right">
                          <i class="fa fa-plus-square" onClick="addMultiWords(this)"></i>
                        </span>
                    </div>
                    <ul class="aa">
                        <li class="checkbox">
                            <label>
                                <input type="checkbox" value="北京">北京
                            </label>
                            <span class="pull-right">
                                <i class="fa fa-pencil-square text-gray"></i>
                                <i class="fa fa-trash text-danger"></i>
                            </span>
                        </li>
                        <li class="checkbox">
                            <label>
                                <input type="checkbox" value="天津">天津
                            </label>
                            <span class="pull-right">
                                <i class="fa fa-pencil-square text-gray"></i>
                                <i class="fa fa-trash text-danger"></i>
                            </span>
                        </li>
                        <li class="checkbox">
                            <label>
                                <input type="checkbox" value="西安">西安
                            </label>
                            <span class="pull-right">
                                <i class="fa fa-pencil-square text-gray"></i>
                                <i class="fa fa-trash text-danger"></i>
                            </span>
                        </li>
                    </ul>
                </div>
                <button class="btn btn-warning btn-block" type="button" onClick="CleanContent('aa')">清空地区</button>
            </div>

            <div class="col-xs-12 col-sm-6 col-md-4 col-lg-2dot4">
                <div class="thumbnail thum" style="border:1px solid #d6e9c6;">
                    <div class="bg-info" style="background-color: #dff0d8; color:#3c763d">
                        <span class="pull-left">
                            <div class="checkbox titleWord2">
                                <label>
                                    <input type="checkbox"/>
                                    <strong>关键词</strong>
                                </label>
                            </div>
                        </span>
                        <span class="pull-right">
                            <i class="fa fa-plus-square" onClick="addMultiWords(this)"></i>
                        </span>
                    </div>
                    <ul class="bb">
                        <li class="checkbox">
                            <label>
                                <input type="checkbox" value="挖掘机"/>挖掘机
                            </label>
                            <span class="pull-right">
                                <i class="fa fa-pencil-square text-gray"></i>
                                <i class="fa fa-trash text-danger"></i>
                            </span>
                        </li>
                        <li class="checkbox">
                            <label>
                                <input type="checkbox" value="西瓜"/>西瓜
                            </label>
                            <span class="pull-right">
                                <i class="fa fa-pencil-square text-gray"></i>
                                <i class="fa fa-trash text-danger"></i>
                            </span>
                        </li>
                    </ul>
                </div>
                <button class="btn btn-warning btn-block" type="button" onClick="CleanContent('bb')">清空关键词</button>
            </div>

            <div class="col-xs-12 col-sm-6 col-md-4 col-lg-2dot4">
                <div class="thumbnail thum" style="border:1px solid #d6e9c6;">
                    <div class="bg-info" style="background-color: #dff0d8; color:#3c763d">
                        <span class="pull-left">
                            <div class="checkbox titleWord3">
                                <label>
                                    <input type="checkbox"/>
                                    <strong>品牌</strong>
                                </label>
                            </div>
                        </span>
                        <span class="pull-right">
                            <i class="fa fa-plus-square" onClick="addMultiWords(this)"></i>
                        </span>
                    </div>
                    <ul class="cc">
                        <li class="checkbox">
                            <label>
                                <input type="checkbox" value="小松"/>小松
                            </label>
                            <span class="pull-right">
                                <i class="fa fa-pencil-square text-gray"></i>
                                <i class="fa fa-trash text-danger"></i>
                            </span>
                        </li>
                    </ul>
                </div>
                <button class="btn btn-warning btn-block" type="button" onClick="CleanContent('cc')">清空关键词</button>
            </div>

            <div class="col-xs-12 col-sm-6 col-md-4 col-lg-2dot4">
                <div class="thumbnail thum" style="border:1px solid #d6e9c6;">
                    <div class="bg-info" style="background-color: #dff0d8; color:#3c763d">
                        <span class="pull-left">
                            <div class="checkbox titleWord4">
                                <label>
                                    <input type="checkbox"/>
                                    <strong>业务</strong>
                                </label>
                            </div>
                        </span>
                        <span class="pull-right">
                            <i class="fa fa-plus-square" onClick="addMultiWords(this)"></i>
                        </span>
                    </div>
                    <ul class="dd">
                        <li class="checkbox">
                            <label>
                                <input type="checkbox" value="配件"/>配件
                            </label>
                            <span class="pull-right">
                                <i class="fa fa-pencil-square text-gray"></i>
                                <i class="fa fa-trash text-danger"></i>
                            </span>
                        </li>
                    </ul>
                </div>
                <button class="btn btn-warning btn-block" type="button" onClick="CleanContent('dd')">清空关键词</button>
            </div>

            <div class="col-xs-12 col-sm-6 col-md-4 col-lg-2dot4">
                <div class="thumbnail thum" style="border:1px solid #d6e9c6;">
                    <div class="bg-info" style="background-color: #dff0d8; color:#3c763d">
                        <span class="pull-left">
                            <div class="checkbox titleWord5">
                                <label>
                                    <input type="checkbox"/>
                                    <strong>修饰词</strong>
                                </label>
                            </div>
                        </span>
                        <span class="pull-right">
                            <i class="fa fa-plus-square" onClick="addMultiWords(this)"></i>
                        </span>
                    </div>
                    <ul class="ee">
                        <li class="checkbox">
                            <label>
                                <input type="checkbox" value="厂家直销"/>厂家直销
                            </label>
                            <span class="pull-right">
                                <i class="fa fa-pencil-square text-gray"></i>
                                <i class="fa fa-trash text-danger"></i>
                            </span>
                        </li>
                        <li class="checkbox">
                            <label>
                                <input type="checkbox" value="专业快递"/>专业快递
                            </label>
                            <span class="pull-right">
                                <i class="fa fa-pencil-square text-gray"></i>
                                <i class="fa fa-trash text-danger"></i>
                            </span>
                        </li>
                    </ul>
                </div>
                <button class="btn btn-warning btn-block" type="button" onClick="CleanContent('ee')">清空关键词</button>
            </div>

        </div>
    </div>
    <div class="container" style="margin-top: 10px">
        <button class="btn btn-danger btn-block btn-lg title" type="button">生成标题</button>
    </div>
</form>
<!-- 别删除下面的两行 -->
<li id="cloneitem" class="checkbox hide">
    <label><input type="checkbox"/></label>
    <span class="pull-right">
        <i class="fa fa-pencil-square text-gray"></i>
        <i class="fa fa-trash text-danger"></i>
    </span>
</li>

<!--添加-->
<div class="modal fade" role="dialog" aria-hidden="true" id="multiwords">
    <form role="form">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <h4 class="modal-title">
                        <span id="multiwordstitle"></span>
                    </h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <span class="help-block">更多词语（每行一个）</span>
                        <textarea class="form-control" id="multitext" rows="10" required/></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">取 消</button>
                    <button type="button" class="btn btn-warning" onClick="doMultiWords()">保 存</button>
                </div>
            </div>
        </div>
    </form>
</div>

<!--编辑-->
<div class="modal fade" role="dialog" aria-hidden="true" id="singlewords">
    <form role="form">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <h4 class="modal-title">编辑词语</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <span class="help-block">更多词语（每行一个）</span>
                        <input class="form-control" type="text" id="singletext" required/>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">取 消</button>
                    <button type="button" class="btn btn-warning" onClick="doSingleWords()">保 存</button>
                </div>
            </div>
        </div>
    </form>
</div>
<!--生成标题-->
<div class="modal fade" role="dialog" aria-hidden="true" id="gentitle">
    <form role="form">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                    <h4 class="modal-title"> 已生成标题 (<span id="gentitletotal"></span>个)</h4>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <textarea class="form-control" rows="30" id="gentitletext"/>努力生成标题中... 请稍候...</textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关 闭</button>
                </div>
            </div>
        </div>
    </form>
</div>
<script src="jquery.min.js"></script>
<script src="bootstrap.min.js"></script>
<script>
    var storage = $.localStorage;
    $(window).ready(function () {
        //编辑按钮
        $("[class='fa fa-pencil-square text-gray']").click(function () {
            editSingleWords($(this));
        });

        //删除按钮
        $("[class='fa fa-trash text-danger']").click(function () {
            deleteSingleWords($(this));
        });

        //标题模板选择
        $('#formattitles').find('a').click(function () {
            $('#formattitle').val($(this).text());
            makesnapshot();
            $(this).parents('.dropdown').removeClass('open');
            return false;
        });

        //初始化
        setColumn('aa');
        setColumn('bb');
        setColumn('cc');
        setColumn('dd');
        setColumn('ee');
        if (!storage.isEmpty('formattitle')) {
            $('#formattitle').val(storage.get('formattitle'));
        }
        //存储在本地
        $('#forminfo').change(function () {
            makesnapshot()
        });
    });
    //单个词语
    var whichsingle = null;
    function editSingleWords(btn) {
        whichsingle = btn;
        text = btn.parents('span').prev('label').text();
        $('#singletext').val(text.trim());
        $('#singlewords').modal('show');
    }
    function doSingleWords() {
        var text = $('#singletext').val();
        var html = '<input type="checkbox" value="'+text+'">' + text;
        $(whichsingle).parents('li').find('label').html(html);
        $('#singlewords').modal('hide');
        makesnapshot();
    }
    function deleteSingleWords(btn) {
        btn.parents('li').remove();
        makesnapshot();
    }
    //多行词语
    var whichmulti = null;
    function addMultiWords(btn) {
        $('#multiwordstitle').html('添加' + $(btn).parents('.bg-info').find('label').text());
        whichmulti = btn;
        $('#multitext').val('');
        $('#multiwords').modal('show');
    }
    function doMultiWords() {
        var multitext = $('#multitext').val().split("\n");
        var container = $(whichmulti).parents('.bg-info').next('ul');
        container.find('label').each(function () {
            t = $(this).text();
            idx = multitext.indexOf(t);
            if (idx != -1) {
                multitext.splice(idx, 1);
            }
        });
        for (var i in multitext) {
            var clone = $('#cloneitem').clone();
            clone.removeClass('hide');
            clone.removeAttr('id');
            var text = multitext[i];
            var html = '<input type="checkbox" value="'+text+'">' + text;
            if (text.trim() == '') continue;
            clone.find('label').html(html);
            clone.find('label').prop('title', text);
            clone.find("[class='fa fa-pencil-square text-gray']").click(function () {
                editSingleWords($(this))
            });
            clone.find("[class='fa fa-trash text-danger']").click(function () {
                deleteSingleWords($(this))
            });
            container.prepend(clone);
        }
        $('#multiwords').modal('hide');
        makesnapshot();
    }
    function makesnapshot() {
        storage.removeAll();
        storage.set('formattitle', $('#formattitle').val());
        storage.set('aa', getColumn('aa'));
        storage.set('bb', getColumn('bb'));
        storage.set('cc', getColumn('cc'));
        storage.set('dd', getColumn('dd'));
        storage.set('ee', getColumn('ee'));
    }
    function getColumn(column) {
        var rs = {};
        $('.' + column).find('li').each(function () {
            var text = $(this).find('label').text();
            var bool = $(this).find('input').prop('checked');
            rs[text] = bool;
        });
        return rs;
    }
    function setColumn(column) {
        if (storage.isEmpty(column)) return;
        var container = $('.' + column);
        container.empty();
        var data = storage.get(column);
        $.each(data, function (i, e) {
            var clone = $('#cloneitem').clone();
            clone.removeClass('hide');
            clone.removeAttr('id');
            var text = i;
            var html = '<input type="checkbox" ' + (e ? 'checked' : '') + '>' + text;
            clone.find('label').html(html);
            clone.find('label').prop('title', text);
            clone.find("[class='fa fa-pencil-square text-gray']").click(function () {
                editSingleWords($(this))
            });
            clone.find("[class='fa fa-trash text-danger']").click(function () {
                deleteSingleWords($(this))
            });
            container.append(clone);
        });
    };
    //全选和取消全选
    $(".titleWord1 input[type=checkbox]").click(function(){
        $('.aa input[type=checkbox]').each(function () {
            if ($(this).prop("checked")) {
                $(this).removeAttr("checked");
            } else {
                $(this).prop("checked","true");
            }
        })
    });
    $(".titleWord2 input[type=checkbox]").click(function(){
        $('.bb input[type=checkbox]').each(function () {
            if ($(this).prop("checked")) {
                $(this).removeAttr("checked");
            } else {
                $(this).prop("checked",'true');
            }
        })
    });
    $(".titleWord3 input[type=checkbox]").click(function(){
        $('.cc input[type=checkbox]').each(function () {
            if ($(this).prop("checked")) {
                $(this).removeAttr("checked");
            } else {
                $(this).prop("checked",'true');
            }
        })
    });
    $(".titleWord4 input[type=checkbox]").click(function(){
        $('.dd input[type=checkbox]').each(function () {
            if ($(this).prop("checked")) {
                $(this).removeAttr("checked");
            } else {
                $(this).prop("checked",'true');
            }
        })
    });
    $(".titleWord5 input[type=checkbox]").click(function(){
        $('.ee input[type=checkbox]').each(function () {
            if ($(this).prop("checked")) {
                $(this).removeAttr("checked");
            } else {
                $(this).prop("checked",'true');
            }
        })
    });
    $(".title").click(function(){
        var aa = [],bb=[],cc=[],dd=[],ee=[];
        $('.aa input[type=checkbox]').each(function(){
            if($(this)[0].checked){
                aa.push($(this).val());
            }
        });
        $('.bb input[type=checkbox]').each(function(){
            if($(this)[0].checked){
                bb.push($(this).val());
            }
        });
        $('.cc input[type=checkbox]').each(function(){
            if($(this)[0].checked){
                cc.push($(this).val());
            }
        });
        $('.dd input[type=checkbox]').each(function(){
            if($(this)[0].checked){
                dd.push($(this).val());
            }
        });
        $('.ee input[type=checkbox]').each(function(){
            if($(this)[0].checked){
                ee.push($(this).val());
            }
        });
        var data=[];
        data = abc(data ,aa);
        data = abc(data ,bb);
        data = abc(data ,cc);
        data = abc(data ,dd);
        data = abc(data ,ee);
        var string ='';
        for(var i=0;i<data.length;i++){
            $("#gentitletotal").html(i+1);
            string += data[i]+'\n';
            $("#gentitletext").html(string);
        }

        $('#gentitle').modal('show');
    });
    function abc(a ,b){
        var c = new Array();
        if(b.length == 0){
            for(var k = 0 ; k < a.length ; k++){
                c.push(a[k]);
            }
        }
        if(a.length > 0 && b.length > 0){
            for(var i = 0 ; i < a.length ; i++){
                for(var j = 0 ; j < b.length ; j++){
                    c.push(a[i]+b[j]);
                }
            }
        }else if(b.length > 0){
            for(var j = 0 ; j < b.length ; j++){
                c.push(b[j]);
            }
        }
        return c;
    }
    function CleanContent(column) {
        var container = $('.' + column);
        container.empty();
        storage.remove(column);
    }
</script>
</body>
</html>
